// Prisma schema for Job Application Auto-Fill Extension

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String         @id @default(uuid())
  email         String         @unique
  password      String
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  profile       Profile?
  unknownFields UnknownField[]
}

model Profile {
  id        String   @id @default(uuid())
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Personal Information
  firstName       String?
  lastName        String?
  email           String?
  phone           String?
  address         String?
  city            String?
  state           String?
  zipCode         String?
  country         String?

  // Professional Information
  currentJobTitle String?
  currentCompany  String?
  linkedinUrl     String?
  portfolioUrl    String?
  githubUrl       String?

  // Work Authorization
  workAuthorization    String?  // e.g., "US Citizen", "Green Card", "H1B", etc.
  willingToRelocate    Boolean  @default(false)
  salaryExpectation    String?
  availableStartDate   String?

  // Education
  degree           String?
  university       String?
  graduationYear   String?
  gpa              String?
  fieldOfStudy     String?

  // Experience & Skills
  yearsOfExperience String?
  skills            String?  // Comma-separated skills
  summary           String?  // Professional summary/objective

  // Resume & Cover Letter
  resumeFileName    String?
  resumeData        String?  // Base64 encoded resume or URL
  coverLetter       String?  // Default cover letter text
}

model UnknownField {
  id          String   @id @default(uuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  fieldName   String   // The name/id attribute of the field
  fieldLabel  String?  // Human-readable label if detected
  fieldType   String   // input, select, textarea, etc.
  placeholder String?  // Placeholder text if any
  pageUrl     String   // URL where the field was found
  pageDomain  String   // Domain for grouping
  
  userValue   String?  // Value provided by user for this field
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([userId, fieldName, pageDomain])
}
